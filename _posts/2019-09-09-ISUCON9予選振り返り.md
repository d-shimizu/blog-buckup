---
layout: post
Categories:  ["tech"]
Description:  " ISUCON9に参加したので振り返りとして書いておく。 "
Tags: ["ISUCON", "tech"]
date: "2019-09-09T01:00:00+09:00"
title: "ISUCON9予選振り返り"
author: "dshimizu"
archive: ["2019"]
draft: "true"
---

<body>
<p>ISUCON9に参加したので振り返りとして書いておく。</p>

<iframe class="embed-card embed-webcard" style="display: block; width: 100%; height: 155px; max-width: 500px; margin: 10px 0px;" title="ISUCON9 まとめ : ISUCON公式Blog" src="https://hatenablog-parts.com/embed?url=http://isucon.net/archives/53570241.html" frameborder="0" scrolling="no"></iframe>

</body>

<!-- more -->

<body>
<p>ちなみに負けた。</p>

<h3>振り返り</h3>


<p>今回のお題は椅子限定のフリマアプリ「ISUCARI」だった。</p>

<ul>
    <li><a target="_brank" rel="noopener noreferrer" href="http://isucon.net/archives/53789931.html">ISUCON9 予選問題の解説と講評 : ISUCON公式Blog</a></li>
</ul>


<p>そのアプリケーションに加えて、決済と発送が外部サービスとなっていて、それぞれの<a class="keyword" href="http://d.hatena.ne.jp/keyword/API">API</a>へアクセスするようになっていた。
かなりよく作られたアプリケーションだと思った。
また、ベンチマーカーも例年通り<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%C0%A5%C3%A5%B7%A5%E5">ダッシュ</a>ボード混みで完成度の高い感じだった。</p>

<p>僕はインフラ担当として参加した。
インフラは今年はAlibaba Cloudが使われていた。でも、Alibaba Cloudの知識はそこまで必要なく、セキュリティグループに気をつける程度だった。
決められた<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%A4%A5%F3%A5%B9%A5%BF%A5%F3%A5%B9">インスタンス</a>を3台まで使って良いと言う形だった。</p>

<h4>思ったこと</h4>


<ul>
    <li>ツールにとらわれ過ぎていた。</li>
過去のISUCON参加者の方のブログとかを見ると、<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%A2%A5%AF%A5%BB%A5%B9%A5%ED%A5%B0">アクセスログ</a>の解析にalpを使われていたり、OSリソースの可視化にnetdataを使われているのをよく見る。でも、alpを見てもどのパスにどれくらいのアクセスがあったかくらいはわかるが、それがどう言う理由で遅いかを解析するには<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%A2%A5%AF%A5%BB%A5%B9%A5%ED%A5%B0">アクセスログ</a>から得られる情報だけではわからなかった。今回だと/loginへのアクセスでbcryptのハッシュ処理で重かったようだが全然気づけなかった。netdataも単一のホストの情報を見るには良さそうだが、複数台の情報を見るには逆に情報量が多過ぎてあまり向いていないように感じた。
    <li>
<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%DC%A5%C8%A5%EB%A5%CD%A5%C3%A5%AF">ボトルネック</a>の解析力と限られた複数台のサーバを限られた時間内でうまく使いこなすためのが足りない。</li>
一番重要な部分な気がするが、やはりこれが足りない。基本的にはWeb/AP/DBで、必要ならCacheを組み合わせたり...と言う構成ではあるものの、色々な組み合わせ方がある。今回は1台目のサーバに<a class="keyword" href="http://d.hatena.ne.jp/keyword/MySQL">MySQL</a>(DB)とProxy扱いのNginxを置き、残りの2台にアプリを置いて振り分ける、みたいな構成をとったが、その場でチームメンバーと話合ってはいたものの、なんとなくリソースをうまく使えそうだから、と言う理由でそうした。でも本来はどこが<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%DC%A5%C8%A5%EB%A5%CD%A5%C3%A5%AF">ボトルネック</a>かもう少し明確にしてから構成の変更を検討すべきだった気がする。
    <li>アプリケーションの挙動をきちんと把握できなかった。</li>
オペレーションやインフラ構成周りばかりに気を取られていて、<a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%A6%A5%A7%A5%D6%A5%B5%A1%BC%A5%D3%A5%B9">ウェブサービス</a>としてブラウザからひと通りの導線を踏んでみるとか、データの中身を見るとか、レギュレーションをしっかり読む(きちんと理解する)と言うことが足りなかった。この辺りしっかりやっていれば気づける部分はもう少しあったかもしれない。</ul>


<h3>まとめ</h3>


<p>色々反省点ばかりだけど、普段と違った刺激が多くて今年も楽しめた。
問題は年々難しくなっている気がするけど、もっと力をつけて来年も挑戦したい。</p>

<p>最後に、運営のみなさま、今年も素晴らしいイベントをありがとうございました。</p>
</body>
