---
layout: post
Categories:  ["tech"]
Description:  " はじめに  2013年9月30日にFreeBSD 9.2-RELEASEがリリースされました。ZFSやDTraceといった注目の機能が強化されているようです。      FreeBSD 9.2-RELEASE Announcement  "
Tags: ["FreeBSD", "さくらのVPS"]
date: "2013-10-05T19:51:00+09:00"
title: "FreeBSD 9.1-RELEASEをFreeBSD 9.2-RELEASEへアップグレード"
author: "dshimizu"
archive: ["2013"]
draft: "true"
---

<body>
<h4>はじめに</h4>
<p>2013年9月30日に<a class="keyword" href="http://d.hatena.ne.jp/keyword/FreeBSD">FreeBSD</a> 9.2-RELEASEがリリースされました。<a class="keyword" href="http://d.hatena.ne.jp/keyword/ZFS">ZFS</a>やDTraceといった注目の機能が強化されているようです。 </p>
<ul>  <li><a href="http://www.freebsd.org/releases/9.2R/announce.html">FreeBSD 9.2-RELEASE Announcement</a></li>
</ul>
<p>早速、さくらの<a class="keyword" href="http://d.hatena.ne.jp/keyword/VPS">VPS</a>で使っている<a class="keyword" href="http://d.hatena.ne.jp/keyword/FreeBSD">FreeBSD</a> 9.1-RELEASEを<a class="keyword" href="http://d.hatena.ne.jp/keyword/FreeBSD">FreeBSD</a> 9.2-RELEASEへアップグレードしましたので、その際の手順を記載しておきます。 </p> <a name="more"></a> <h4>
<a class="keyword" href="http://d.hatena.ne.jp/keyword/FreeBSD">FreeBSD</a> 9.1-RELEASEから<a class="keyword" href="http://d.hatena.ne.jp/keyword/FreeBSD">FreeBSD</a> 9.2-RELEASEへのアップグレード</h4>
<p>アップグレード(マイナーバージョンアップ)は公式マニュアルに記載されている手順を元に実施します。 </p>
<ul>  <li><a href="http://www.freebsd.org/doc/ja/books/handbook/updating-upgrading-freebsdupdate.html#freebsdupdate-upgrade">18.2. FreeBSD Update</a></li>
</ul> <h5>環境</h5>
<p>環境は以下の通りです。 </p>
<table>
<tr>  <td bgcolor="#cccccc">プラットフォーム</td>  <td>さくらの<a class="keyword" href="http://d.hatena.ne.jp/keyword/VPS">VPS</a> 512</td>
</tr>
<tr>  <td bgcolor="#cccccc">OS</td>  <td>
<a class="keyword" href="http://d.hatena.ne.jp/keyword/FreeBSD">FreeBSD</a> 9.1-RELEASE(GENERIC <a class="keyword" href="http://d.hatena.ne.jp/keyword/%A5%AB%A1%BC%A5%CD%A5%EB">カーネル</a>) <a class="keyword" href="http://d.hatena.ne.jp/keyword/amd64">amd64</a> on <a class="keyword" href="http://d.hatena.ne.jp/keyword/ZFS">ZFS</a> </td>
</tr>
</table> <h5>アップグレード</h5>
<p>アップグレードを実施します。まず、rootにスイッチします。 </p>
<pre class="terminal">  $ su -  
</pre>
<p><a class="keyword" href="http://d.hatena.ne.jp/keyword/freebsd">freebsd</a>-updateコマンドを実行して、更新内容を取得します。-rオプションで9.2-RELEASEを指定し、upgradeオプションを付けます。<br>更新されるファイルに対して、何度か"Does this look reasonable (y/n)?(これは妥当ですか？)といったことを聞かれるので"y"と入力します。 </p>
<pre class="terminal">  # freebsd-update -r 9.2-RELEASE upgrade Looking up update.FreeBSD.org mirrors... 5 mirrors found. Fetching public key from update4.freebsd.org... done. Fetching metadata signature for 9.1-RELEASE from update4.freebsd.org... done. Fetching metadata index... done. Fetching 2 metadata files... done. Inspecting system... done.  The following components of FreeBSD seem to be installed: kernel/generic src/src world/base  The following components of FreeBSD do not seem to be installed: world/doc world/games world/lib32  Does this look reasonable (y/n)? y … … … /usr/src/usr.sbin/zzz/zzz.8 /usr/src/usr.sbin/zzz/zzz.sh /var/db/mergemaster.mtree /var/named/etc/namedb/master/empty.db /var/named/etc/namedb/master/localhost-forward.db /var/named/etc/namedb/master/localhost-reverse.db /var/named/etc/namedb/named.conf /var/named/etc/namedb/named.root /var/yp/Makefile.dist To install the downloaded upgrades, run "/usr/sbin/freebsd-update install".  </pre> <p>上記"<a class="keyword" href="http://d.hatena.ne.jp/keyword/freebsd">freebsd</a>-update"実行後の最後のメッセージにある通りに、"<a class="keyword" href="http://d.hatena.ne.jp/keyword/freebsd">freebsd</a>-update install"を実行し、修正ファイルを反映(ディスクへ書き込み)します。 </p>
<pre class="terminal">  # freebsd-update install Installing updates... Kernel updates have been installed.  Please reboot and run "/usr/sbin/freebsd-update install" again to finish installing updates.  </pre> <p>"<a class="keyword" href="http://d.hatena.ne.jp/keyword/freebsd">freebsd</a>-update install"実行時の最後のメッセージにある通りに、システムの再起動を実施し、起動後再度"<a class="keyword" href="http://d.hatena.ne.jp/keyword/freebsd">freebsd</a>-update install"を実行して古いライブラリ等を削除します。 </p>
<pre class="terminal">  #  shutdown -r now Shutdown NOW! shutdown: [pid 35368] root@hostname:/root # *** FINAL System shutdown message from xxxxx@hostname.sakura.ne.jp ***  System going down IMMEDIATELY  </pre> <pre class="terminal">  # freebsd-update install Installing updates... done.  
</pre>
<p>マイナーバージョンアップですので、<a class="keyword" href="http://d.hatena.ne.jp/keyword/ports">ports</a>の再構築等は必要ありません。これでアップグレードは終了です。 </p> <h4>おわりに</h4>
<p><a class="keyword" href="http://d.hatena.ne.jp/keyword/ZFS">ZFS</a>環境だったのでそれが影響して問題が発生しないか心配しましたが、処理に時間がかかっただけで特に問題なく進みました。<br>記事と関係ないですが、jailを試してみたい… </p>
</body>

<!-- more -->


